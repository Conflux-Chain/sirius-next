{"version":3,"sources":["../../../src/components/Charts/PreviewChartTemplate.tsx"],"sourcesContent":["import { useEffect, useRef, useCallback } from 'react';\nimport Highcharts from 'highcharts/highstock';\nimport HighchartsReact from 'highcharts-react-official';\nimport useSWR from 'swr';\nimport PreviewTitle from './PreviewTitle';\nimport { sendRequestChart } from '../../utils/request';\nimport lodash from 'lodash';\nimport {\n  ChartsProps,\n  optsOrigin,\n  previewOpts,\n  defaultLimit,\n  defaultIntervalType,\n  ConstructorType,\n} from './config';\n\nexport function PreviewChartTemplate({ options, request }: ChartsProps) {\n  const chart = useRef(null);\n  const limit = request?.query?.limit || defaultLimit;\n  const intervalType = request?.query?.intervalType || defaultIntervalType;\n\n  const sendRequestCallback = useCallback(() => {\n    return sendRequestChart({\n      url: request.url,\n      query: {\n        ...request.query,\n        limit,\n        intervalType,\n      },\n    });\n  }, [request.url, request.query, intervalType]);\n\n  const { data, isLoading } = useSWR(\n    request.url + intervalType + limit,\n    sendRequestCallback,\n    {\n      revalidateOnFocus: false,\n    },\n  );\n\n  useEffect(() => {\n    if (isLoading) {\n      // @ts-ignore\n      chart.current?.chart.showLoading();\n    } else {\n      // @ts-ignore\n      chart.current?.chart.hideLoading();\n    }\n  }, [isLoading]);\n\n  const optsOrigins = optsOrigin({ options, request, data });\n  const opts = lodash.merge(optsOrigins, options, previewOpts);\n  opts.intervalType = { value: intervalType };\n  const constructorType = ConstructorType({ options, request });\n  return (\n    <div className=\"bg-[#FFFFFF] border border-[#E5E5E5] rounded-lg shadow-sm\">\n      <PreviewTitle header={opts.header}></PreviewTitle>\n      <div className=\"p-[1.2857rem]\">\n        <HighchartsReact\n          constructorType={constructorType}\n          highcharts={Highcharts}\n          options={opts}\n          ref={chart}\n        />\n      </div>\n    </div>\n  );\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,SAAS,WAAW,QAAQ,mBAAmB;AAC/C,OAAO,gBAAgB;AACvB,OAAO,qBAAqB;AAC5B,OAAO,YAAY;AAGnB,OAAO,YAAY;AAiDf,SACE,KADF;AAvCG,SAAS,qBAAqB,EAAE,SAAS,QAAQ,GAAgB;AACtE,QAAM,QAAQ,OAAO,IAAI;AACzB,QAAM,QAAQ,SAAS,OAAO,SAAS;AACvC,QAAM,eAAe,SAAS,OAAO,gBAAgB;AAErD,QAAM,sBAAsB,YAAY,MAAM;AAC5C,WAAO,iBAAiB;AAAA,MACtB,KAAK,QAAQ;AAAA,MACb,OAAO;AAAA,QACL,GAAG,QAAQ;AAAA,QACX;AAAA,QACA;AAAA,MACF;AAAA,IACF,CAAC;AAAA,EACH,GAAG,CAAC,QAAQ,KAAK,QAAQ,OAAO,YAAY,CAAC;AAE7C,QAAM,EAAE,MAAM,UAAU,IAAI;AAAA,IAC1B,QAAQ,MAAM,eAAe;AAAA,IAC7B;AAAA,IACA;AAAA,MACE,mBAAmB;AAAA,IACrB;AAAA,EACF;AAEA,YAAU,MAAM;AACd,QAAI,WAAW;AAEb,YAAM,SAAS,MAAM,YAAY;AAAA,IACnC,OAAO;AAEL,YAAM,SAAS,MAAM,YAAY;AAAA,IACnC;AAAA,EACF,GAAG,CAAC,SAAS,CAAC;AAEd,QAAM,cAAc,WAAW,EAAE,SAAS,SAAS,KAAK,CAAC;AACzD,QAAM,OAAO,OAAO,MAAM,aAAa,SAAS,WAAW;AAC3D,OAAK,eAAe,EAAE,OAAO,aAAa;AAC1C,QAAM,kBAAkB,gBAAgB,EAAE,SAAS,QAAQ,CAAC;AAC5D,SACE,qBAAC,SAAI,WAAU,6DACb;AAAA,wBAAC,wBAAa,QAAQ,KAAK,QAAQ;AAAA,IACnC,oBAAC,SAAI,WAAU,iBACb;AAAA,MAAC;AAAA;AAAA,QACC;AAAA,QACA,YAAY;AAAA,QACZ,SAAS;AAAA,QACT,KAAK;AAAA;AAAA,IACP,GACF;AAAA,KACF;AAEJ;","names":[]}